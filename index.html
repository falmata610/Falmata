<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MiniAmazon - Demo Store</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
<style>
  /* Reset & base */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0; font-family: 'Roboto', sans-serif; background: #fff; color: #111;
    min-height: 100vh; display: flex; flex-direction: column;
  }
  a {
    color: #0073bb; text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }

  /* Header */
  header {
    background: #131921;
    color: white;
    padding: 10px 20px;
    display: flex;
    align-items: center;
    position: sticky;
    top: 0; z-index: 1000;
  }

  header .logo {
    font-size: 1.8rem;
    font-weight: 700;
    letter-spacing: 1.2px;
    margin-right: 15px;
    cursor: pointer;
  }

  /* Search Bar */
  .search-bar {
    flex: 1;
    display: flex;
    align-items: center;
  }
  .search-bar input {
    flex: 1;
    padding: 8px 15px;
    border: none;
    border-radius: 4px 0 0 4px;
    font-size: 1rem;
  }
  .search-bar button {
    background: #febd69;
    border: none;
    padding: 9px 15px;
    border-radius: 0 4px 4px 0;
    cursor: pointer;
    font-weight: 700;
    color: #111;
    transition: background-color 0.3s ease;
  }
  .search-bar button:hover {
    background: #f3a847;
  }

  /* Nav right buttons */
  .nav-right {
    display: flex;
    align-items: center;
    gap: 18px;
    margin-left: 20px;
  }
  .nav-right button {
    background: none;
    border: none;
    color: white;
    font-weight: 600;
    cursor: pointer;
    font-size: 1rem;
  }
  .nav-right button:hover {
    text-decoration: underline;
  }

  /* Cart icon with badge */
  .cart-icon {
    position: relative;
    cursor: pointer;
    font-size: 1.8rem;
  }
  .cart-count {
    position: absolute;
    top: -6px;
    right: -12px;
    background: #f08804;
    color: black;
    font-weight: 700;
    font-size: 0.75rem;
    padding: 3px 7px;
    border-radius: 50%;
    user-select: none;
  }

  /* Main container */
  main {
    flex: 1;
    max-width: 1200px;
    margin: 30px auto;
    padding: 0 15px;
    display: flex;
    gap: 30px;
    flex-wrap: wrap;
  }

  /* Sidebar categories */
  aside.categories {
    width: 200px;
    border-right: 1px solid #ddd;
    padding-right: 15px;
  }
  aside.categories h2 {
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 10px;
  }
  aside.categories ul {
    list-style: none;
    padding: 0;
  }
  aside.categories li {
    margin-bottom: 10px;
  }
  aside.categories li button {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1rem;
    color: #0073bb;
  }
  aside.categories li button.active {
    font-weight: 700;
    text-decoration: underline;
    color: #b4690e;
  }

  /* Products grid */
  section.products {
    flex: 1;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
    gap: 25px;
  }

  /* Single product card */
  .product-card {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgb(0 0 0 / 0.1);
    padding: 15px;
    display: flex;
    flex-direction: column;
    transition: box-shadow 0.3s ease;
  }
  .product-card:hover {
    box-shadow: 0 8px 20px rgb(0 0 0 / 0.15);
  }
  .product-card img {
    width: 100%;
    height: 180px;
    object-fit: contain;
    margin-bottom: 12px;
  }
  .product-card h3 {
    font-size: 1.1rem;
    margin: 0 0 5px;
    font-weight: 700;
    color: #111;
  }
  .product-card p {
    font-size: 0.9rem;
    color: #444;
    flex: 1;
    margin-bottom: 10px;
  }
  .product-price {
    font-weight: 700;
    font-size: 1.2rem;
    color: #b4690e;
    margin-bottom: 15px;
  }
  .product-card button {
    background: #febd69;
    border: none;
    padding: 10px 0;
    font-weight: 700;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.3s ease;
    user-select: none;
  }
  .product-card button:hover {
    background: #f3a847;
  }

  /* Cart dropdown */
  .cart-dropdown {
    position: absolute;
    top: 50px;
    right: 20px;
    background: white;
    box-shadow: 0 4px 18px rgb(0 0 0 / 0.2);
    width: 350px;
    border-radius: 6px;
    padding: 15px;
    display: none;
    flex-direction: column;
    max-height: 400px;
    overflow-y: auto;
    z-index: 1100;
  }
  .cart-dropdown.visible {
    display: flex;
  }
  .cart-dropdown h3 {
    margin: 0 0 12px;
    font-weight: 700;
    color: #111;
  }
  .cart-item {
    display: flex;
    align-items: center;
    margin-bottom: 12px;
    gap: 12px;
  }
  .cart-item img {
    width: 55px;
    height: 55px;
    object-fit: contain;
    border-radius: 4px;
  }
  .cart-item-info {
    flex: 1;
  }
  .cart-item-info h4 {
    margin: 0 0 4px;
    font-size: 1rem;
    font-weight: 600;
  }
  .cart-item-info p {
    margin: 0;
    font-size: 0.85rem;
    color: #555;
  }
  .cart-item-qty {
    display: flex;
    align-items: center;
    gap: 5px;
  }
  .cart-item-qty button {
    background: #febd69;
    border: none;
    padding: 3px 9px;
    font-weight: 700;
    cursor: pointer;
    border-radius: 4px;
    user-select: none;
  }
  .cart-item-qty span {
    min-width: 20px;
    text-align: center;
  }
  .cart-item-remove {
    background: none;
    border: none;
    color: #c00;
    font-weight: 700;
    cursor: pointer;
    font-size: 0.9rem;
    user-select: none;
  }

  .cart-total {
    font-weight: 700;
    font-size: 1.2rem;
    margin-top: 12px;
    text-align: right;
    border-top: 2px solid #eee;
    padding-top: 12px;
  }
  .cart-dropdown button.checkout-btn {
    margin-top: 15px;
    background: #0073bb;
    color: white;
    border: none;
    padding: 12px 0;
    font-weight: 700;
    border-radius: 6px;
    cursor: pointer;
    width: 100%;
    font-size: 1.1rem;
    user-select: none;
    transition: background-color 0.3s ease;
  }
  .cart-dropdown button.checkout-btn:hover {
    background: #005fa3;
  }

  /* Login/Signup modal */
  .modal-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.5);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1200;
  }
  .modal-backdrop.visible {
    display: flex;
  }
  .modal {
    background: white;
    width: 360px;
    border-radius: 8px;
    padding: 25px 30px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    position: relative;
  }
  .modal h2 {
    margin-top: 0;
    margin-bottom: 20px;
    font-weight: 700;
    text-align: center;
    color: #111;
  }
  .modal label {
    font-weight: 600;
    font-size: 0.95rem;
  }
  .modal input {
    width: 100%;
    padding: 10px 12px;
    margin: 8px 0 15px;
    border: 1.5px solid #ddd;
    border-radius: 4px;
    font-size: 1rem;
  }
  .modal button {
    background: #febd69;
    border: none;
    padding: 12px 0;
    font-weight: 700;
    width: 100%;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  .modal button:hover {
    background: #f3a847;
  }
  .modal .close-btn {
    position: absolute;
    right: 15px;
    top: 15px;
    font-size: 1.4rem;
    background: none;
    border: none;
    cursor: pointer;
    font-weight: 700;
  }
  .modal .toggle-mode {
    margin-top: 12px;
    text-align: center;
    font-size: 0.9rem;
    color: #0073bb;
    cursor: pointer;
  }
  .modal .toggle-mode:hover {
    text-decoration: underline;
  }

  /* Footer */
  footer {
    background: #131921;
    color: white;
    text-align: center;
    padding: 15px 10px;
    font-size: 0.9rem;
  }

  /* Responsive */
  @media (max-width: 800px) {
    main {
      flex-direction: column;
      max-width: 100%;
      margin: 20px 10px;
    }
    aside.categories {
      width: 100%;
      border: none;
      padding: 0 0 20px 0;
      margin-bottom: 15px;
      display: flex;
      overflow-x: auto;
      border-bottom: 1px solid #ddd;
    }
    aside.categories ul {
      display: flex;
      gap: 12px;
    }
    aside.categories li {
      margin-bottom: 0;
    }
    section.products {
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    }
    .cart-dropdown {
      width: 90vw;
      right: 5vw;
      max-height: 300px;
    }
  }

</style>
</head>
<body>

<header>
  <div class="logo" tabindex="0" aria-label="MiniAmazon Home">MiniAmazon</div>
  <form class="search-bar" role="search" aria-label="Product search">
    <input type="search" placeholder="Search products..." aria-label="Search products" id="search-input" />
    <button type="submit" aria-label="Search">Search</button>
  </form>
  <nav class="nav-right" aria-label="User menu">
    <button id="login-btn" aria-haspopup="dialog">Sign In</button>
    <button id="signup-btn" aria-haspopup="dialog">Register</button>
    <div class="cart-icon" id="cart-icon" tabindex="0" aria-label="View shopping cart">
      ðŸ›’
      <span class="cart-count" aria-live="polite" aria-atomic="true" id="cart-count">0</span>
    </div>
  </nav>
</header>

<main>
  <aside class="categories" aria-label="Product categories">
    <h2>Categories</h2>
    <ul id="category-list">
      <!-- Categories buttons injected here -->
    </ul>
  </aside>
  <section class="products" id="product-list" aria-live="polite" aria-atomic="true">
    <!-- Products injected here -->
  </section>
</main>

<!-- Cart dropdown -->
<div class="cart-dropdown" id="cart-dropdown" aria-label="Shopping cart details" role="region" aria-live="polite" aria-atomic="true">
  <h3>Your Cart</h3>
  <div id="cart-items">
    <p>Your cart is empty.</p>
  </div>
  <div class="cart-total" id="cart-total">Total: $0.00</div>
  <button class="checkout-btn" id="checkout-btn">Checkout</button>
</div>

<!-- Login/Signup Modal -->
<div class="modal-backdrop" id="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1">
  <div class="modal" role="document">
    <button class="close-btn" id="modal-close" aria-label="Close dialog">&times;</button>
    <h2 id="modal-title">Sign In</h2>
    <form id="auth-form">
      <label for="email">Email:</label>
      <input type="email" id="email" required autocomplete="username" />
      <label for="password">Password:</label>
      <input type="password" id="password" required autocomplete="current-password" />
      <button type="submit" id="auth-submit">Sign In</button>
    </form>
    <div class="toggle-mode" id="toggle-auth-mode">Don't have an account? Register</div>
  </div>
</div>

<footer>
  &copy; 2025 MiniAmazon. Demo Store. No real transactions.
</footer>

<script>
  // PRODUCTS DATA
  const products = [
    {id: 1, name: "Men's Cotton T-Shirt", description: "Soft, comfortable cotton tee.", price: 19.99, image: "https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=400&q=80", category: "Tees"},
    {id: 2, name: "Classic Mug", description: "Ceramic coffee mug.", price: 9.99, image: "https://images.unsplash.com/photo-1509042239860-f550ce710b93?auto=format&fit=crop&w=400&q=80", category: "Mugs"},
    {id: 3, name: "Smart Watch", description: "Track your fitness goals.", price: 129.99, image: "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=400&q=80", category: "Electronics"},
    {id: 4, name: "Leather Handbag", description: "Elegant and versatile accessory.", price: 89.99, image: "https://images.unsplash.com/photo-1514996937319-344454492b37?auto=format&fit=crop&w=400&q=80", category: "Bags"},
    {id: 5, name: "Bluetooth Headphones", description: "Wireless over-ear headphones.", price: 59.99, image: "https://images.unsplash.com/photo-1516707531591-b4f8b7c20e8b?auto=format&fit=crop&w=400&q=80", category: "Electronics"},
    {id: 6, name: "Coffee Mug - Blue", description: "Blue glazed mug.", price: 11.99, image: "https://images.unsplash.com/photo-1509042239860-f550ce710b93?auto=format&fit=crop&w=400&q=80", category: "Mugs"},
    {id: 7, name: "Running Shoes", description: "Comfortable and stylish.", price: 75.00, image: "https://images.unsplash.com/photo-1513104890138-7c749659a591?auto=format&fit=crop&w=400&q=80", category: "Shoes"},
    {id: 8, name: "Classic Baseball Cap", description: "Adjustable cap with logo.", price: 15.50, image: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80", category: "Accessories"},
  ];

  const categories = ["All", "Tees", "Mugs", "Electronics", "Bags", "Shoes", "Accessories"];

  // State
  let cart = {};
  let filteredCategory = "All";
  let filteredSearch = "";
  let isCartOpen = false;
  let isUserLoggedIn = false;
  let currentUser = null;

  // Cached elements
  const categoryList = document.getElementById("category-list");
  const productList = document.getElementById("product-list");
  const cartIcon = document.getElementById("cart-icon");
  const cartCountEl = document.getElementById("cart-count");
  const cartDropdown = document.getElementById("cart-dropdown");
  const cartItemsEl = document.getElementById("cart-items");
  const cartTotalEl = document.getElementById("cart-total");
  const checkoutBtn = document.getElementById("checkout-btn");

  const loginBtn = document.getElementById("login-btn");
  const signupBtn = document.getElementById("signup-btn");
  const modalBackdrop = document.getElementById("modal-backdrop");
  const modalCloseBtn = document.getElementById("modal-close");
  const authForm = document.getElementById("auth-form");
  const authTitle = modalBackdrop.querySelector("#modal-title");
  const authSubmitBtn = document.getElementById("auth-submit");
  const toggleAuthMode = document.getElementById("toggle-auth-mode");

  const searchInput = document.getElementById("search-input");

  // --- RENDERING ---

  function renderCategories() {
    categoryList.innerHTML = "";
    categories.forEach(cat => {
      const li = document.createElement("li");
      const btn = document.createElement("button");
      btn.textContent = cat;
      btn.classList.toggle("active", cat === filteredCategory);
      btn.addEventListener("click", () => {
        filteredCategory = cat;
        renderCategories();
        renderProducts();
      });
      li.appendChild(btn);
      categoryList.appendChild(li);
    });
  }

  function renderProducts() {
    productList.innerHTML = "";
    let filtered = products;
    if(filteredCategory !== "All") {
      filtered = filtered.filter(p => p.category === filteredCategory);
    }
    if(filteredSearch.trim() !== "") {
      const searchLower = filteredSearch.trim().toLowerCase();
      filtered = filtered.filter(p =>
        p.name.toLowerCase().includes(searchLower) ||
        p.description.toLowerCase().includes(searchLower)
      );
    }
    if(filtered.length === 0) {
      productList.innerHTML = `<p>No products found.</p>`;
      return;
    }
    filtered.forEach(p => {
      const card = document.createElement("article");
      card.className = "product-card";
      card.tabIndex = 0;
      card.innerHTML = `
        <img src="${p.image}" alt="${p.name}" loading="lazy" />
        <h3>${p.name}</h3>
        <p>${p.description}</p>
        <div class="product-price">$${p.price.toFixed(2)}</div>
        <button aria-label="Add ${p.name} to cart" data-id="${p.id}">Add to Cart</button>
      `;
      const btn = card.querySelector("button");
      btn.addEventListener("click", () => addToCart(p.id));
      productList.appendChild(card);
    });
  }

  function renderCart() {
    cartItemsEl.innerHTML = "";
    const cartEntries = Object.entries(cart);
    if(cartEntries.length === 0) {
      cartItemsEl.innerHTML = `<p>Your cart is empty.</p>`;
      cartTotalEl.textContent = `Total: $0.00`;
      return;
    }
    let total = 0;
    cartEntries.forEach(([id, qty]) => {
      const product = products.find(p => p.id === Number(id));
      const subtotal = product.price * qty;
      total += subtotal;
      const div = document.createElement("div");
      div.className = "cart-item";
      div.innerHTML = `
        <img src="${product.image}" alt="${product.name}" />
        <div class="cart-item-info">
          <p>${product.name}</p>
          <p>Qty: ${qty}</p>
          <p>$${subtotal.toFixed(2)}</p>
          <button aria-label="Remove one ${product.name} from cart" data-id="${id}">-</button>
          <button aria-label="Add one ${product.name} to cart" data-id="${id}">+</button>
          <button aria-label="Remove all ${product.name} from cart" data-id="${id}">Remove</button>
        </div>
      `;
      const minusBtn = div.querySelector("button:nth-of-type(1)");
      const plusBtn = div.querySelector("button:nth-of-type(2)");
      const removeBtn = div.querySelector("button:nth-of-type(3)");
      minusBtn.addEventListener("click", () => removeOneFromCart(id));
      plusBtn.addEventListener("click", () => addToCart(id));
      removeBtn.addEventListener("click", () => removeAllFromCart(id));
      cartItemsEl.appendChild(div);
    });
    cartTotalEl.textContent = `Total: $${total.toFixed(2)}`;
  }

  // --- CART OPERATIONS ---

  function addToCart(id) {
    if(!isUserLoggedIn) {
      alert("Please sign in to add items to your cart.");
      return;
    }
    if(cart[id]) {
      cart[id]++;
    } else {
      cart[id] = 1;
    }
    updateCartCount();
    renderCart();
  }

  function removeOneFromCart(id) {
    if(cart[id]) {
      cart[id]--;
      if(cart[id] <= 0) delete cart[id];
      updateCartCount();
      renderCart();
    }
  }

  function removeAllFromCart(id) {
    if(cart[id]) {
      delete cart[id];
      updateCartCount();
      renderCart();
    }
  }

  function updateCartCount() {
    const totalQty = Object.values(cart).reduce((a,b) => a + b, 0);
    cartCountEl.textContent = totalQty;
  }

  // --- MODAL LOGIN/SIGNUP ---

  let isLoginMode = true;

  function openModal(login=true) {
    isLoginMode = login;
    authTitle.textContent = login ? "Sign In" : "Register";
    authSubmitBtn.textContent = login ? "Sign In" : "Register";
    toggleAuthMode.textContent = login ? "Don't have an account? Register" : "Already have an account? Sign In";
    modalBackdrop.style.display = "flex";
    authForm.reset();
    emailInput.focus();
  }

  function closeModal() {
    modalBackdrop.style.display = "none";
  }

  loginBtn.addEventListener("click", () => openModal(true));
  signupBtn.addEventListener("click", () => openModal(false));
  modalCloseBtn.addEventListener("click", closeModal);
  modalBackdrop.addEventListener("click", (e) => {
    if(e.target === modalBackdrop) closeModal();
  });

  toggleAuthMode.addEventListener("click", () => {
    openModal(!isLoginMode);
  });

  const emailInput = document.getElementById("email");
  const passwordInput = document.getElementById("password");

  // Simulated user database (in localStorage)
  // users stored as { email: string, password: string (plain for demo only) }

  function getUsers() {
    return JSON.parse(localStorage.getItem("users") || "[]");
  }

  function saveUsers(users) {
    localStorage.setItem("users", JSON.stringify(users));
  }

  function authUser(email, password) {
    const users = getUsers();
    return users.find(u => u.email === email && u.password === password);
  }

  function registerUser(email, password) {
    let users = getUsers();
    if(users.find(u => u.email === email)) {
      return false; // user exists
    }
    users.push({email, password});
    saveUsers(users);
    return true;
  }

  authForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const email = emailInput.value.trim().toLowerCase();
    const password = passwordInput.value.trim();
    if(isLoginMode) {
      const user = authUser(email, password);
      if(user) {
        isUserLoggedIn = true;
        currentUser = user;
        alert("Logged in successfully!");
        closeModal();
        loginBtn.style.display = "none";
        signupBtn.style.display = "none";
      } else {
        alert("Invalid email or password.");
      }
    } else {
      // Register
      if(registerUser(email, password)) {
        alert("Registration successful. Please sign in.");
        openModal(true);
      } else {
        alert("Email already registered.");
      }
    }
  });

  // --- SEARCH ---

  document.querySelector(".search-bar").addEventListener("submit", (e) => {
    e.preventDefault();
    filteredSearch = searchInput.value;
    renderProducts();
  });

  // --- CART TOGGLE ---

  cartIcon.addEventListener("click", () => {
    if(!isUserLoggedIn) {
      alert("Please sign in to view your cart.");
      return;
    }
    isCartOpen = !isCartOpen;
    cartDropdown.style.display = isCartOpen ? "block" : "none";
    if(isCartOpen) renderCart();
  });

  // Checkout button (dummy)
  checkoutBtn.addEventListener("click", () => {
    if(!isUserLoggedIn) {
      alert("Please sign in to checkout.");
      return;
    }
    if(Object.keys(cart).length === 0) {
      alert("Your cart is empty.");
      return;
    }
    alert("Thank you for your purchase! (Demo only, no real transactions)");
    cart = {};
    updateCartCount();
    renderCart();
    cartDropdown.style.display = "none";
    isCartOpen = false;
  });

  // INITIALIZE
  renderCategories();
  renderProducts();
  updateCartCount();

</script>

</body>
</html>
